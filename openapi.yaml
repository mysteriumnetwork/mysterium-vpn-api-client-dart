openapi: 3.0.0
info:
  title: MysteriumVPN API
  version: '1.0'
servers:
  - description: development
    url: http://localhost:3030/api/v1
  - description: test
    url: https://api-test.mysteriumvpn.com/api/v1
  - description: production
    url: https://api.mysteriumvpn.com/api/v1
components:
  schemas:
    FieldError:
      type: object
      properties:
        code:
          type: string
        message:
          type: string
      required:
        - code
        - message
    APIError:
      type: object
      properties:
        status:
          type: integer
          nullable: true
        path:
          type: string
          nullable: true
        error:
          type: object
          properties:
            code:
              type: string
            message:
              type: string
            detail:
              type: string
              nullable: true
            fields:
              type: object
              nullable: true
              additionalProperties:
                type: object
                properties:
                  code:
                    type: string
                  message:
                    type: string
                required:
                  - code
                  - message
          required:
            - code
            - message
      required:
        - error
    OAuth2TokenRequest:
      oneOf:
        - type: object
          properties:
            grant_type:
              type: string
              enum:
                - refresh_token
            client_id:
              type: string
              enum: &ref_0
                - web
                - app
                - extension
            refresh_token:
              type: string
          required:
            - grant_type
            - client_id
            - refresh_token
        - type: object
          properties:
            grant_type:
              type: string
              enum:
                - authorization_code
            client_id:
              type: string
              enum: *ref_0
            code_verifier:
              type: string
            code:
              type: string
          required:
            - grant_type
            - client_id
            - code_verifier
            - code
        - type: object
          properties:
            grant_type:
              type: string
              enum:
                - google
            code:
              type: string
              nullable: true
              description: Google authorization code for retrieving access token
            google_id_token:
              type: string
              nullable: true
              description: >-
                Google access token. Required if authorization code is not
                provided.
          required:
            - grant_type
        - type: object
          properties:
            grant_type:
              type: string
              enum:
                - apple
            authorization:
              type: object
              properties:
                id_token:
                  type: string
              required:
                - id_token
          required:
            - grant_type
            - authorization
    OAuth2TokenResponse:
      type: object
      properties:
        access_token:
          type: string
        token_type:
          type: string
          enum:
            - bearer
        expires_in:
          type: number
          nullable: true
        refresh_token:
          type: string
          nullable: true
        user_id:
          type: string
      required:
        - access_token
        - token_type
        - user_id
    AuthCheckResponse:
      type: object
      properties:
        username:
          type: string
          example: batman@mysteriumvpn.com
        user_id:
          type: string
          format: uuid
          example: 000000f2-398e-4c40-9c10-c201a37eda0d
      required:
        - username
        - user_id
    AuthConfigResponse:
      type: object
      properties:
        google_client_id:
          type: string
        apple_service_id:
          type: string
      required:
        - google_client_id
        - apple_service_id
    ConnectionLocationsRequestQuery:
      type: object
      properties:
        ip_type:
          type: string
          nullable: true
          enum: &ref_1
            - ''
            - hosting
            - residential
    ConnectionLocationCity:
      type: object
      properties:
        city:
          type: string
          example: Vilnius
        total:
          type: number
          example: 1
        translations:
          type: object
          additionalProperties:
            type: string
          example:
            en: Vilnius
      required:
        - city
        - total
        - translations
    ConnectionLocation:
      type: object
      properties:
        country:
          type: string
          example: LT
        total:
          type: number
          example: 1
        cities:
          type: array
          items:
            $ref: '#/components/schemas/ConnectionLocationCity'
        translations:
          type: object
          additionalProperties:
            type: string
          example:
            en: Republic of Lithuania
      required:
        - country
        - total
        - cities
        - translations
    ConnectionLocationsResponse:
      type: array
      items:
        $ref: '#/components/schemas/ConnectionLocation'
    ConnectionConfigRegionsQuery:
      type: object
      properties:
        ip_type:
          type: string
          nullable: true
          enum: &ref_2
            - ''
            - hosting
            - residential
    ConnectionRegion:
      type: object
      properties:
        id:
          type: string
          example: america1
        host:
          type: string
          example: america1.mysteriumvpn.com
        port:
          type: number
          example: 56666
        port_healthcheck:
          type: number
          example: 80
        top_countries:
          type: array
          items:
            type: string
          example:
            - SE
            - CA
      required:
        - id
        - host
        - port
        - port_healthcheck
        - top_countries
    ConnectionConfigRegionsResponse:
      type: object
      properties:
        regions:
          type: array
          items:
            $ref: '#/components/schemas/ConnectionRegion'
      required:
        - regions
    ConnectionConfigRequestQuery:
      type: object
      properties:
        ip_type:
          type: string
          nullable: true
          enum: &ref_3
            - ''
            - hosting
            - residential
    ConnectionConfigResponse:
      type: object
      properties:
        countries:
          type: array
          items:
            type: string
          example:
            - DE
            - MX
            - PA
            - SE
            - BR
            - CA
        top_countries:
          type: array
          items:
            type: string
          example:
            - SE
            - CA
      required:
        - countries
        - top_countries
    WireguardConnectRequest:
      type: object
      properties:
        public_key:
          type: string
          example: aJxmamM5IUbxkevqSGcOIASETCxeRl71iXPVbqT1gz0=
        country_originate:
          type: string
          nullable: true
          example: DE
        country:
          type: string
          nullable: true
          example: DE
        ip_type:
          type: string
          nullable: true
          examples:
            - residential
            - hosting
            - cellular
        reset_connection:
          type: boolean
          nullable: true
          description: Request a new IP
        os_type:
          type: string
          nullable: true
          examples:
            - ios
            - macos
            - android
            - windows
      required:
        - public_key
    WireguardConnectResponse:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier of prepared connection
        wg_config:
          type: string
          description: >-
            Wireguard connection configuration with a placeholder for
            %private_key%
        hash:
          type: string
          description: Hash representing provider id
        exit_ip:
          type: string
          nullable: true
          description: Exit IP of provider
        limit_exceeded:
          type: boolean
          nullable: true
      required:
        - id
        - wg_config
        - hash
    HttpsConnectRequest:
      type: object
      properties:
        country_originate:
          type: string
          nullable: true
          example: DE
        country:
          type: string
          nullable: true
          example: DE
        ip_type:
          type: string
          nullable: true
          examples:
            - residential
            - hosting
            - cellular
        reset_connection:
          type: boolean
          nullable: true
          description: Request a new IP
        os_type:
          type: string
          nullable: true
          examples:
            - ios
            - macos
            - android
            - windows
            - web
    ProxyConnectResponse:
      type: object
      properties:
        proxy_config:
          type: object
          properties:
            host:
              type: string
            port:
              type: string
            username:
              type: string
            password:
              type: string
            expires_at:
              type: string
              format: date-time
          required:
            - host
            - port
            - username
            - password
            - expires_at
          description: Proxy connection configuration
        limit_exceeded:
          type: boolean
          nullable: true
      required:
        - proxy_config
    DisconnectQuery:
      type: object
      properties:
        public_key:
          type: string
          description: Public key of the Wireguard connection
          example: aJxmamM5IUbxkevqSGcOIASETCxeRl71iXPVbqT1gz0=
      required:
        - public_key
    RateConnectionRequest:
      type: object
      properties:
        country:
          type: string
          description: Country code where the connection is made from
          example: DE
        ip_type:
          type: string
          examples:
            - residential
            - hosting
            - cellular
        public_key:
          type: string
          example: aJxmamM5IUbxkevqSGcOIASETCxeRl71iXPVbqT1gz0=
        feedback:
          type: string
          nullable: true
          description: Feedback about the connection
          example: Great connection, no issues
        reasons:
          type: string
          default: ''
          description: Reasons for the feedback
          example: Speed, stability
        mode:
          type: string
          enum:
            - like
            - dislike
          description: Mode of the feedback
          example: like
      required:
        - country
        - ip_type
        - public_key
        - mode
    MarketingPermissionsRequest:
      type: object
      properties:
        consent:
          type: boolean
          description: User's consent for marketing communications
          example: true
      required:
        - consent
    ConnectionKilledMessage:
      type: object
      properties:
        reason:
          type: string
          enum:
            - disconnect_all
            - connection_limit
      required:
        - reason
    ConnectionMessage:
      type: object
      properties:
        location:
          type: object
          properties:
            ip:
              type: string
              format: ip
              example: 127.0.0.1
            country:
              type: string
              example: US
            node_type:
              type: string
              example: residential
          required:
            - ip
            - country
            - node_type
      required:
        - location
    HealthcheckResponse:
      type: object
      properties:
        status:
          type: string
          example: OK
        version:
          type: string
        sha:
          type: string
      required:
        - status
        - version
        - sha
    HealthcheckMessage:
      type: object
      properties:
        status:
          type: string
          example: OK
        version:
          type: string
        sha:
          type: string
      required:
        - status
        - version
        - sha
    MagicLinkRedirectRequestQuery:
      type: object
      properties:
        code:
          type: string
          minLength: 1
        continue_to:
          type: string
          nullable: true
        redirect_url:
          type: string
          nullable: true
      required:
        - code
    MagicLinkRequest:
      type: object
      properties:
        email:
          type: string
          format: email
        client_id:
          type: string
          enum: *ref_0
        code_challenge:
          type: string
        code_challenge_method:
          type: string
          enum:
            - plain
            - S256
            - s256
        continue_to:
          type: string
          nullable: true
          description: User will be continue to this path upon authentication
      required:
        - email
        - client_id
        - code_challenge
        - code_challenge_method
    MagicLinkResponse:
      type: object
      properties:
        code:
          type: string
          nullable: true
    CodeAuthorizationRequest:
      type: object
      properties:
        response_type:
          type: string
          enum:
            - code
        client_id:
          type: string
          enum: *ref_0
        code_challenge:
          type: string
        code_challenge_method:
          type: string
          enum:
            - plain
            - S256
            - s256
      required:
        - response_type
        - client_id
        - code_challenge
        - code_challenge_method
    ActivationAuthorizationRequest:
      type: object
      properties:
        response_type:
          type: string
          enum:
            - activation_none
        client_id:
          type: string
          enum: *ref_0
        request_id:
          type: string
          format: uuid
      required:
        - response_type
        - client_id
        - request_id
    OAuth2AuthorizationRequest:
      anyOf:
        - $ref: '#/components/schemas/CodeAuthorizationRequest'
        - $ref: '#/components/schemas/ActivationAuthorizationRequest'
    OAuth2AuthorizationResponse:
      type: object
      properties:
        code:
          type: string
      required:
        - code
    OAuth2TokenIntrospectionRequest:
      type: object
      properties:
        token:
          type: string
          nullable: true
          description: >-
            Token to be introspected. Optional when token is presented via
            Authorization header.
    OAuth2TokenIntrospectionResponse:
      type: object
      properties:
        active:
          type: boolean
          description: >-
            Boolean indicator of whether or not the presented token is currently
            active
        username:
          type: string
          nullable: true
          description: Username (e-mail) associated with the presented token
        sub:
          type: string
          nullable: true
          description: User ID
        exp:
          type: number
          nullable: true
          description: >-
            Integer timestamp, measured in the number of seconds since January 1
            1970 UTC, indicating when this token will expire, as defined in JWT
      required:
        - active
    LocationRate:
      type: object
      properties:
        name:
          type: string
        code:
          type: string
        rate:
          type: string
      required:
        - name
        - code
        - rate
    Country:
      allOf:
        - $ref: '#/components/schemas/LocationRate'
        - type: object
          properties:
            states:
              type: array
              nullable: true
              items:
                $ref: '#/components/schemas/LocationRate'
    SubscriptionConfigResponse:
      type: object
      properties:
        gateways:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
                example: stripe
              enabled:
                type: boolean
            required:
              - name
              - enabled
        plans:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
                example: plan_monthly
              apple_product_id:
                type: string
              google_product_id:
                type: string
              interval:
                type: object
                properties:
                  unit:
                    type: string
                    enum:
                      - year
                      - month
                  amount:
                    type: number
                required:
                  - unit
                  - amount
              price:
                type: object
                properties:
                  USD:
                    type: number
                required:
                  - USD
              prices:
                type: array
                items:
                  type: object
                  properties:
                    currency:
                      type: string
                    discount_amount:
                      type: string
                    discount_units:
                      type: string
                    discounted_full_price:
                      type: string
                    discounted_monthly_price:
                      type: string
                    full_price:
                      type: string
                    monthly_price:
                      type: string
                  required:
                    - currency
                    - discount_amount
                    - discount_units
                    - discounted_full_price
                    - discounted_monthly_price
                    - full_price
                    - monthly_price
              supported_gateways:
                type: array
                items:
                  type: string
                example:
                  - stripe
                  - paypal
                  - apple
                  - google
                  - coingate
            required:
              - id
              - apple_product_id
              - google_product_id
              - interval
              - price
              - prices
              - supported_gateways
        countries:
          type: array
          items:
            $ref: '#/components/schemas/Country'
        stripe_return_url:
          type: string
        stripe_publishable_key:
          type: string
      required:
        - gateways
        - plans
        - countries
        - stripe_return_url
        - stripe_publishable_key
    CreateGenericSubscriptionRequest:
      type: object
      properties:
        gateway_id:
          type: string
        plan_id:
          type: string
        country:
          type: string
        state:
          type: string
          nullable: true
        currency:
          type: string
        zip_code:
          type: string
          nullable: true
        coupon_code:
          type: string
          nullable: true
        embedded:
          type: boolean
          nullable: true
          enum:
            - true
        card_holder:
          type: string
          nullable: true
      required:
        - gateway_id
        - plan_id
        - country
        - currency
    CreateGoogleSubscriptionRequest:
      type: object
      properties:
        gateway_id:
          type: string
          enum:
            - google
        plan_id:
          type: string
      required:
        - gateway_id
        - plan_id
    CreateAppleSubscriptionRequest:
      type: object
      properties:
        gateway_id:
          type: string
          enum:
            - apple
        plan_id:
          type: string
      required:
        - gateway_id
        - plan_id
    CreateAdyenSubscriptionRequest:
      type: object
      properties:
        plan_id:
          type: string
        country:
          type: string
        state:
          type: string
          nullable: true
        currency:
          type: string
        zip_code:
          type: string
          nullable: true
        coupon_code:
          type: string
          nullable: true
        embedded:
          type: boolean
          nullable: true
          enum:
            - true
        card_holder:
          type: string
          nullable: true
        express:
          type: boolean
          nullable: true
        amount:
          type: number
        origin:
          type: string
        gateway_id:
          type: string
          enum:
            - adyen
        payment_data:
          nullable: true
      required:
        - plan_id
        - country
        - currency
        - amount
        - origin
        - gateway_id
    CreateGenericSubscriptionResponse:
      type: object
      properties:
        gateway_id:
          type: string
        checkout_url:
          type: string
          nullable: true
        client_secret:
          type: string
          nullable: true
        invoice_paid:
          type: boolean
          nullable: true
        subscription_id:
          type: string
          nullable: true
      required:
        - gateway_id
    CreateGoogleSubscriptionResponse:
      type: object
      properties:
        gateway_id:
          type: string
        subscription_base_plan_id:
          type: string
        subscription_product_id:
          type: string
      required:
        - gateway_id
        - subscription_base_plan_id
        - subscription_product_id
    CreateAppleSubscriptionResponse:
      type: object
      properties:
        gateway_id:
          type: string
        subscription_product_id:
          type: string
      required:
        - gateway_id
        - subscription_product_id
    CreateAdyenSubscriptionResponse:
      type: object
      properties:
        gateway_id:
          type: string
        subscription_id:
          type: string
        payment_data:
          nullable: true
      required:
        - gateway_id
        - subscription_id
    GetSubscriptionResponse:
      type: object
      properties:
        active:
          type: boolean
        period_start:
          type: string
          nullable: true
          format: date-time
        active_until:
          type: string
          nullable: true
          format: date-time
        gateway:
          type: string
          nullable: true
        plan_id:
          type: string
          nullable: true
        portal_url:
          type: string
          nullable: true
        expired:
          type: boolean
        recurring:
          type: boolean
        subscription_id:
          type: string
        order_currency:
          type: string
          nullable: true
        order_net_amount:
          type: string
          nullable: true
        order_coupon_used:
          type: string
          nullable: true
      required:
        - active
        - expired
        - recurring
        - subscription_id
    GetLocationResponse:
      type: object
      properties:
        country:
          type: string
      required:
        - country
    UserCallbackRequest:
      type: object
      properties:
        gateway_id:
          type: string
          enum:
            - apple
            - google
        payload:
          type: string
          nullable: true
          description: Purchase token from Google or Apple (deprecated) receipt data
        transaction_id:
          type: string
          nullable: true
          description: Transaction ID from Apple
      required:
        - gateway_id
    OrderSummaryRequest:
      type: object
      properties:
        country:
          type: string
        state:
          type: string
          nullable: true
        plan_id:
          type: string
        coupon_code:
          type: string
          nullable: true
      required:
        - country
        - plan_id
    OrderSummaryResponse:
      type: object
      properties:
        currency:
          type: string
        item_name:
          type: string
        item_subtotal:
          type: string
        tax_name:
          type: string
        tax_subtotal:
          type: string
        order_total:
          type: string
        discount_amount:
          type: string
          nullable: true
        discount_units:
          type: string
          nullable: true
        item_subtotal_before_discount:
          type: string
        tax_subtotal_before_discount:
          type: string
        total_price_before_discount:
          type: string
      required:
        - currency
        - item_name
        - item_subtotal
        - tax_name
        - tax_subtotal
        - order_total
        - item_subtotal_before_discount
        - tax_subtotal_before_discount
        - total_price_before_discount
    InvoicesRequest:
      type: object
      properties:
        page:
          type: string
        page_size:
          type: string
      required:
        - page
        - page_size
    Invoice:
      type: object
      properties:
        id:
          type: string
        plan_id:
          type: string
        amount_gross:
          type: string
        name:
          type: string
        gateway:
          type: string
        status:
          type: string
        created_at:
          type: string
          format: date-time
      required:
        - id
        - plan_id
        - amount_gross
        - name
        - gateway
        - status
        - created_at
    InvoicesResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/Invoice'
        paging:
          type: object
          properties:
            page:
              type: number
            page_size:
              type: number
            total_count:
              type: number
          required:
            - page
            - page_size
            - total_count
      required:
        - data
        - paging
  parameters: {}
paths:
  /oauth/token:
    post:
      operationId: token
      tags:
        - authentication
      summary: >-
        OAuth Token endpoint [RFC 6749]. Requires Proof Key for Code Exchange
        (PKCE) [RFC 7636].
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/OAuth2TokenRequest'
          application/json:
            schema:
              $ref: '#/components/schemas/OAuth2TokenRequest'
      responses:
        '200':
          description: Authentication successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuth2TokenResponse'
  /auth/activation:
    post:
      operationId: requestActivation
      tags:
        - authentication
      summary: Create session activation request
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  format: uuid
              required:
                - id
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    format: uuid
                  valid:
                    type: boolean
                  token:
                    allOf:
                      - $ref: '#/components/schemas/OAuth2TokenResponse'
                      - nullable: true
                required:
                  - id
                  - valid
  /auth/activation/{id}:
    get:
      operationId: getActivationStatus
      tags:
        - authentication
      summary: Get activation request status
      parameters:
        - schema:
            type: string
          required: true
          name: id
          in: path
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    format: uuid
                  valid:
                    type: boolean
                  token:
                    allOf:
                      - $ref: '#/components/schemas/OAuth2TokenResponse'
                      - nullable: true
                required:
                  - id
                  - valid
  /auth/check:
    get:
      operationId: checkAuth
      tags:
        - authentication
      summary: Get authentication status
      responses:
        '200':
          description: Successfully authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthCheckResponse'
        '401':
          description: Authentication error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                    nullable: true
                  path:
                    type: string
                    nullable: true
                  error:
                    type: object
                    properties:
                      code:
                        type: string
                      message:
                        type: string
                      detail:
                        type: string
                        nullable: true
                      fields:
                        type: object
                        nullable: true
                        additionalProperties:
                          type: object
                          properties:
                            code:
                              type: string
                            message:
                              type: string
                          required:
                            - code
                            - message
                    required:
                      - code
                      - message
                required:
                  - error
  /auth/config:
    get:
      operationId: authConfig
      tags:
        - authentication
      summary: Get authentication configuration
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthConfigResponse'
  /auth/logout:
    post:
      operationId: logout
      tags:
        - authentication
      summary: Deletes authentication cookie (effective on web only)
      responses:
        '204':
          description: OK
  /connection/locations:
    get:
      operationId: connectionLocations
      tags:
        - connection
      summary: Get connection locations
      parameters:
        - schema:
            type: string
            nullable: true
            enum: *ref_1
          required: false
          name: ip_type
          in: query
      responses:
        '200':
          description: Connection locations
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConnectionLocationsResponse'
  /connection/config/regions:
    get:
      operationId: connectionConfigRegions
      tags:
        - connection
      summary: Get connection region options
      parameters:
        - schema:
            type: string
            nullable: true
            enum: *ref_2
          required: false
          name: ip_type
          in: query
      responses:
        '200':
          description: Connection region options
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConnectionConfigRegionsResponse'
  /connection/config:
    get:
      operationId: connectionConfig
      tags:
        - connection
      summary: Get connection options
      parameters:
        - schema:
            type: string
            nullable: true
            enum: *ref_3
          required: false
          name: ip_type
          in: query
      responses:
        '200':
          description: Connection options
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConnectionConfigResponse'
  /connection/connect:
    post:
      operationId: connect
      tags:
        - connection
      summary: Get Wireguard configuration template given connect options
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WireguardConnectRequest'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WireguardConnectResponse'
  /connection/connect-proxy:
    post:
      operationId: connect-proxy
      tags:
        - connection
      summary: Get proxy configuration given connect options
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HttpsConnectRequest'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProxyConnectResponse'
  /connection/disconnect-all:
    get:
      operationId: disconnect-all
      tags:
        - connection
      summary: Disconnect all Wireguard connections
      responses:
        '200':
          description: Success
  /connection/disconnect:
    get:
      operationId: disconnect
      tags:
        - connection
      summary: Disconnect from the current Wireguard connection
      parameters:
        - schema:
            type: string
            description: Public key of the Wireguard connection
            example: aJxmamM5IUbxkevqSGcOIASETCxeRl71iXPVbqT1gz0=
          required: true
          name: public_key
          in: query
      responses:
        '200':
          description: Success
  /connection/rate-connection:
    post:
      operationId: rateConnection
      tags:
        - connection
      summary: Rate connection
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RateConnectionRequest'
      responses:
        '200':
          description: Connection rating success response
  /email-marketing/marketing-consent:
    post:
      operationId: setMarketingConsent
      tags:
        - email-marketing
      summary: Set marketing consent
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MarketingPermissionsRequest'
      responses:
        '200':
          description: Marketing consent set successfully
  /healthcheck:
    get:
      operationId: healthcheck
      tags:
        - infrastructure
      summary: Check whether the API is up
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: OK
                  version:
                    type: string
                  sha:
                    type: string
                required:
                  - status
                  - version
                  - sha
  /magic-link/redirect:
    get:
      operationId: redirectMagicLink
      tags:
        - authentication
      summary: Redirect from magic link click
      parameters:
        - schema:
            type: string
            minLength: 1
          required: true
          name: code
          in: query
        - schema:
            type: string
            nullable: true
          required: false
          name: continue_to
          in: query
        - schema:
            type: string
            nullable: true
          required: false
          name: redirect_url
          in: query
      responses:
        '302':
          description: Redirect
  /magic-link:
    post:
      operationId: requestMagicLink
      tags:
        - authentication
      summary: Request magic link
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MagicLinkRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MagicLinkResponse'
  /oauth/introspect:
    post:
      operationId: introspectToken
      tags:
        - authentication
      summary: OAuth Token introspection endpoint [RFC 7662]
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/OAuth2TokenIntrospectionRequest'
          application/json:
            schema:
              $ref: '#/components/schemas/OAuth2TokenIntrospectionRequest'
      responses:
        '200':
          description: Authentication successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuth2TokenIntrospectionResponse'
  /subscription/config:
    get:
      operationId: subscriptionConfig
      tags:
        - subscription
      summary: Get subscription options
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubscriptionConfigResponse'
  /subscription:
    post:
      operationId: subscribe
      tags:
        - subscription
      summary: Create subscription
      requestBody:
        content:
          application/json:
            schema:
              anyOf:
                - $ref: '#/components/schemas/CreateGenericSubscriptionRequest'
                - $ref: '#/components/schemas/CreateGoogleSubscriptionRequest'
                - $ref: '#/components/schemas/CreateAppleSubscriptionRequest'
                - $ref: '#/components/schemas/CreateAdyenSubscriptionRequest'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                anyOf:
                  - $ref: '#/components/schemas/CreateGenericSubscriptionResponse'
                  - $ref: '#/components/schemas/CreateGoogleSubscriptionResponse'
                  - $ref: '#/components/schemas/CreateAppleSubscriptionResponse'
    get:
      operationId: subscriptionStatus
      tags:
        - subscription
      summary: Get subscription status
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetSubscriptionResponse'
  /subscription/location:
    get:
      operationId: location
      tags:
        - location
      summary: Get location
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetLocationResponse'
  /subscription/user-callback:
    post:
      operationId: subscriptionUserCallback
      tags:
        - subscription
      summary: Post user callback of payment
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserCallbackRequest'
      responses:
        '200':
          description: Success
  /subscription/order-summary:
    post:
      operationId: orderSummary
      tags:
        - subscription
      summary: Preview order summary breakdown
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrderSummaryRequest'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrderSummaryResponse'
  /subscription/invoices:
    post:
      operationId: invoices
      tags:
        - subscription
      summary: Get invoices list with pagination
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InvoicesRequest'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InvoicesResponse'
